# Структура will-файла

Описується структура секцій `will`-файлу та приведено приклади їх застосування

`Will`-файл - конфігураційний файл для побудови [will-модулю](Concepts.ukr.md#module). Може мати розширення '.yml', '.json', '.cson'. `Will`-документ скадається з заголовків та [ресурсів](Concepts.ukr.md#resource) (полів). Заголовоки першого рівня в will-документі - [секції](Concepts.ukr.md#will-file-section) - описують окремі функціональності модуля.  
Структура секцій will-файлу:

```

.will.yml
    ├── about
    ├── submodule
    ├── path
    ├── reflector
    ├── step
    ├── execution
    ├── exported
    └── build

```
Набір і послідовність секцій варіативні і залежать від призначення модуля.

<a name="about"></a> **About.** Секція will-файлу в якій поміщена основна інформація про модуль. Єдина секція яка при відсутності опису генеруєтся пакетом `willbe` автоматично.     
Структура полів секції `about`:

| Поле           | Опис                                    |
|----------------|-----------------------------------------|
| name           | назва модуля; необов'язкове поле        |
| description    | опис (коротка характеристика модуля) - призначення, ліцензія, автори та ін.; необов'язков поле    |
| version        | версія модуля - для позначення прогресу розробки та стану готовності продукту; необов'язков поле  |
| enabled        | стан відображення блоку; обов'язков поле; значення за замовчуванням '1' |
| interpreters   | інтерпретатор модуля; необов'язков поле |
| keywords       | ключові слова; необов'язков поле        |  

<a name="path"></a> **Path.** Секція will-файлу яка описує шляхи до файлів та директорій модуля - карта шляхі. Секція має три вбудовані шляхи: `in`, `out` та `temp`. Директорія на яку вказує `in` - точка відліку для відносних шляхів модуля, тобто,  `willbe` зчитує вказані шляхи починаючи з каталогу `in`, `out` - директорія для експортованих модулів, `temp` - поміщаються тимчасові файли. Якщо `in` не вказаний, то `willbe` починає відлік від кореневої директорії `will`-файла. 
Структура полів секції `path` за замовчуванням:   

| Поле           | Опис                                    |
|----------------|-----------------------------------------|
| path           | шлях до директорії модуля (абсолютний, відносний); необов'язкове поле |
| description    | коротка характеристика створеної директорії; необов'язкове поле     |
| criterion      | критерій створення директорії; необов'язкове поле                   |
| inherit        | наслідування умов створення директорій або вибору файлів; необов'язкове поле  |  

<a name="submodule"></a> **Submodule.** Секція will-файлу яка вказує на окремі will-файли готових [підмодулів](Concepts.ukr.md#submodule) створюваного модулю (супермодулю).  
Структура полів секції `submodule`:  

| Поле           | Опис                                   |
|----------------|----------------------------------------|
| path           | шлях до підмодуля (абсолютний, відносний, URL); необов'язкове поле |
| description    | коротка характеристика підмодуля; необов'язкове поле               |
| criterion      | критерій роботи підмодуля; необов'язкове поле                      |
| inherit        | наслідування підмодулем - можливо включити наслідування властивостей з готового підмодуля; необов'язкове поле    |  

<a name="step"></a> **Step** Секція will-файлу яка описує процедури для виконання в секції `build` при створенні will-модулю. В секції записуються лише процедури користувача.  
Структура полів секції `step`:   

| Поле           | Опис                                   |
|----------------|----------------------------------------|
| description    | коротка характеристика кроку (процедури); необов'язкове поле       |
| criterion      | критерій для виконання процедури; необов'язкове поле               |
| opts           | опції виконання процедури; необов'язкове поле                      |
| inherit        | наслідування процедур - можливість використання готової процедури; необов'язкове поле    |

<a name="reflector"></a> **Reflector.** Секція, що використовує набір функцій по управлінню файловими системами основним призначенням якої є створення сценаріїв файлових операцій модуля.   
Структура полів секції `reflector`:  

| Поле           | Опис                                   |
|----------------|----------------------------------------|
| description    | коротка характеристика рефлектору, його призначення; необов'язкове поле  |
| recursive      | рекурсія - замикання процедури вибору файлів на себе; необов'язкове поле |
| filePath       | шлях до файлів модуля (абсолютний, відносний); обов'язкове поле          |
| src            | ресурси (шляхи) звідки буде зчитано файли; необов'язкове поле            |
| dst            | директорія в яку будут поміщено файли; необов'язкове поле                |
| criterion      | критерій спрацьовування рефлектору; необов'язкове поле                   |
| inherit        | наслідування рефлектором - можливість використання властивості іншого рефлектора; необов'язкове поле    |

<a name="execution"></a> **Execution.** Секція will-файлу яка описує варіанти виконання програми створення складної модульної системи (в стадії розробки).  
<a name="exported"></a> **Exported.** Секція will-файлу яка присутня виключно в автоматично згенерованому `*.out.will`-файлі. `*.out.will` може бути використаний як підмодуль складної системи.  
Структура полів секції `exported`:  

| Поле                     | Опис                                   |
|--------------------------|----------------------------------------|
| version                  | версія модуля, експортується з секції `about`                 |
| description              | опис (коротка характеристика модуля) - призначення, ліцензія, автори та ін. |
| criterion                | критерії, експортовані з секції `build` при виконанні збірки експорту |
| inherit                  | наслідування, яке експортується з секції `build` при виконанні збірки |
| exportedReflector        | рефлектор, який записується в експортованому will-файлі       |
| exportedFilesReflector   | рефлектор на експортовані файли                               |  
| exportedDirPath          | шляхи до директорій, що експотуються                          |
| exportedFilesPath        | шляхи до файлів, що експортуються                             |
| archiveFilePath          | експортовані шляхи для архівованих файлів створеного модулю   |

<a name="build"></a> **Build.** Секція will-файлу яка описує послідовність і умови виконання процедур створення модулю використовуючи значення інших секцій файлу та вбудованих функцій. Для корректної роботи в секції повинна бути присутня принаймні одна процедура. 
Структура полів секції `build`:  

| Поле          | Опис                                    |
|---------------|-----------------------------------------|
| description   | пояснення до збірки модуля; необов'язковий поле                          |  
| criterion     | критерій виконання процедури створення модуля; обов'язкове поле          |
| steps         | процедури створення модуля, описані секцією `step` або вбудовані в пакет; необов'язкове поле                |
| inherit       | наслідування збірником. Якщо вже є описана процедура, можливо включити її наслідування; необов'язкове поле  |  

### Зображення секцій зі складовими
<details>
  <summary><u>Схема секцій will-файлу</u></summary>
<p> </p>
<p>Секція 'path'</p>

![path.section.ukr](./Images/path.section.ukr.png)

<p> </p>
<p>Секція 'submodule'</p>

![submodule.section.ukr](./Images/submodule.section.ukr.png)

<p> </p>
<p>Секція 'reflector'</p>

![reflector.section.ukr](./Images/reflector.section.ukr.png)

</details>

### <a name="examples"></a> Приклади will-файлів

<details>
  <summary><u>Найпростіший will-файл з функцією встановлення пакетів NodeJS</u></summary>

```yaml

about :

  name : first
  description : "First module"
  version : 0.0.1

step :

  npm.install :
    currentPath : '.'
    shell : npm install

build :

  debug:
    criterion :
      default : 1
    steps :
      - npm.install
```

Детальніше в розділі [First will-file](First_will_file.md)
</details>

<details>
  <summary><u>Will-файл з функцією експорту</u></summary>

```yaml

About
  name : 'listing'
  description : 'Module for listing'
  version : '0.0.1'
  enabled : 1

Paths
  in : 'in'
  out : 'out'
  export : 'proto'

step::export.proto
  opts :
    tar : 0
    export : path::export
  inherit :
    export

build::export
  criterion :
    default : 1
    export : 1
  steps :
    export.proto
```
</details>


<details>
  <summary><u>Will-файл з експорту локального модуля</u></summary>

```yaml

about :

  name : semantic-ui
  version : 2.0.7

path :

  out : '.'
  export : '.'

step  :
  export.semantic :
      inherit : export
      tar : 0
      export : path::export

build :
  export :
      criterion :
          default : 1
          export : 1
      steps :
          - export.semantic  
```

</details>

### <a name="conclusion"></a> Підсумок
В цьому розділі описані всі секції `will`-файлу та їх поля за замовчуванням. `Will`-файл в залежності від призначення може містити лише окремі секції з наведеного списку.  
[Секція `about`](#about) має визначену структуру і повинна бути присутня в `will`-файлі. Якщо не описати цю секцію, `willbe` автоматично згенерує її з єдиним встановленим параметом.  
Приведено [декілька конфігурацій](#examples) `will`-файлів.

[Повернутись до змісту](../README.md#manuals)
